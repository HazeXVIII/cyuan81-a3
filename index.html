<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Fitness and Calorie Calculator</title>
        <link rel="stylesheet" href="style.css">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    </head>
    <body>
        <div class="container">
            <div class="tab_box">
                <button class="tab_btn active">Home</button>
                <button class="tab_btn">BMI Calculator</button>
                <button class="tab_btn">Body Fat Calculator</button>
                <button class="tab_btn">Ideal Weight Calculator</button>
                <button class="tab_btn">Daily Caloric Intake Calculator</button>
                <div class="line"></div>
            </div>
            <div class="content_box">
                <div class="content active">
                    <h2>Home</h2>
                    <p>Welcome to the Health and Calorie Calculator.</p>
                </div>

                <div class="content">
                    <h2>BMI Calculator</h2>
                    <p>Enter the following information and click on "Submit" to calculate your BMI.</p>
                    <form>
                        <table>
                            <tr>
                                <td>
                                    <label for="weight">Weight in kilograms:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="weight1" placeholder="Enter your weight" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="height1">Height in meters:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="height1" placeholder="Enter your height" required>
                                </td>
                            </tr>
                        </table>
                    </form>
                    <br>
                    <p id="calculatedBMI"></p>
                    <input type="submit" value="Submit" id="bmi_btn">
                </div>

                <div class="content">
                    <h2>Body Fat Calculator</h2>
                    <p>Enter the following information and click on "Submit" to calculate your Body Fat Percentage.</p>
                    <form>
                        <table>
                            <tr>
                                <td>
                                    <label for="weight2">Weight in kilograms:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="weight2" placeholder="Enter your weight" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="height2">Height in meters:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="height2" placeholder="Enter your height" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="bmi">BMI:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="userBMI" placeholder="Enter your BMI (optional)">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="gender">Gender ("male"/"female"):</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="gender" placeholder="Enter your gender">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="age">Age:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="age" placeholder="Enter your age" required>
                                </td>
                            </tr>
                        </table>
                        <br>
                    </form>
                    <button id="bodyfat_btn">Submit</button>
                    <br><br>
                    <p id="calculatedBodyFat"></p>
                </div>

                <div class="content">
                    <h2>Ideal Weight Calculator</h2>
                    <p>Enter the following information and click on "Submit" to calculate your ideal weight.</p>
                    <form>
                        <table>
                            <tr>
                                <td>
                                    <label for="height3">Height in centimeters:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="height3" placeholder="Enter your height" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="gender2">Gender ("male"/"female"):</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="gender2" placeholder="Enter your gender">
                                </td>
                            </tr>
                        </table>
                        <br>
                    </form>
                    <button id="idealweight_btn">Submit</button>
                    <br><br>
                    <p id="calculatedIdeal"></p>
                </div>

                <div class="content">
                    <h2>Daily Caloric Intake Calculator</h2>
                    <p>Enter the following information and click on "Submit" to calculate the calories 
                        you must consume daily for the selected goal.</p>
                    <form>
                        <table>
                            <tr>
                                <td>
                                    <label for="weight3">Weight in kilograms:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="weight3" placeholder="Enter your weight" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="height4">Height in meters:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="height4" placeholder="Enter your height" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="bmi">BMI:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="userBMI2" placeholder="Enter your BMI (optional)">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="gender3">Gender ("male"/"female"):</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="gender3" placeholder="Enter your gender">
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="age2">Age:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <input type="text" id="age2" placeholder="Enter your age" required>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="goal">Goal:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <select id="goal" name="goal" required>
                                        <option value="weight_loss">I want to lose weight</option>
                                        <option value="weight_maintenance">I want to maintain weight</option>
                                        <option value="weight_gain">I want to gain weight</option>
                                    </select>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <label for="activityLevel">Activity Level:</label>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <select id="activityLevel" name="activityLevel" required>
                                        <option value="sedentary">I live a sedentary lifestyle</option>
                                        <option value="lightly_active">I live a lightly active lifestyle</option>
                                        <option value="active">I live an active lifestyle</option>
                                        <option value="very_active">I live a very active lifestyle</option>
                                    </select>
                                </td>
                            </tr>
                        </table>
                        <br>
                    </form>
                    <button id="calories_btn">Submit</button>
                    <br><br>
                    <p id="calculatedCalories"></p>
                </div>
            </div>
        </div>
        <script>
            const tabs = document.querySelectorAll('.tab_btn');
            const all_content = document.querySelectorAll('.content');
            const bmiBTN = document.querySelector("#bmi_btn");
            const bodyFatBTN = document.querySelector("#bodyfat_btn");
            const idealWeightBTN = document.querySelector("#idealweight_btn");
            const caloriesBTN = document.querySelector("#calories_btn");
            const theIdealWeight = document.querySelector("#calculatedIdeal");
            const theBodyFat = document.querySelector("#calculatedBodyFat");
            const theBMI = document.querySelector("#calculatedBMI");
            const theCalories = document.querySelector("#calculatedCalories");
            const userBMIInput = document.querySelector("#userBMI");
            const userBMIInput2 = document.querySelector("#userBMI2");
            

            // event listener to move amongst tabs and to remove the content from the previous tab
            tabs.forEach((tab, index) => {
                tab.addEventListener('click', (e) => {
                    tabs.forEach(tab => {tab.classList.remove('active')});
                    tab.classList.add('active');

                    var line=document.querySelector('.line');
                line.style.width = e.target.offsetWidth + "px";
                line.style.left = e.target.offsetLeft + "px";

                all_content.forEach(content => {content.classList.remove('active')});
                all_content[index].classList.add('active');
                })
            })

            // adding event listeners to each of the submit buttons
            bmiBTN.addEventListener("click", getBMI);
            bodyFatBTN.addEventListener("click", getBodyFat);
            idealWeightBTN.addEventListener("click", getIdealWeight);
            caloriesBTN.addEventListener("click", getCalories);

            // function to retrieve bmi from local host
            function getBMI() {
                const theWeight = document.querySelector("#weight1").value;
                const theHeight = document.querySelector("#height1").value;

                fetch(`http://localhost:3000/bmi?weight=${theWeight}&height=${theHeight}`)
                .then(res => res.json())
                .then(data => {
                    if (data.bmi === null) {
                        theBMI.innerHTML = "Please fill out all fields.";
                    } else {
                        theBMI.innerHTML = `Your calculated BMI is ${data.bmi}.`;
                    }
                })
            }

            // function to retrieve body fat percentage from local host
            function getBodyFat() {
                const theWeight = document.querySelector("#weight2").value;
                const theHeight = document.querySelector("#height2").value;
                const theBMI = userBMIInput.value;
                const theGender = document.querySelector("#gender").value;
                const theAge = document.querySelector("#age").value;

                if (theBMI === "") {
                    fetch(`http://localhost:3000/bodyfat?weight=${theWeight}&height=${theHeight}
                    &age=${theAge}&gender=${theGender}`)
                    .then(res => res.json())
                    .then(data => {
                        if (data.bodyFat === null) {
                            theBodyFat.innerHTML = "Please fill out all fields.";
                        } else {
                            theBodyFat.innerHTML = `Your calculated body fat percentage is ${data.bodyFat}%.`;
                        }
                    })                
                } else {
                    fetch(`http://localhost:3000/bodyfat?bmi=${theBMI}&age=${theAge}&gender=${theGender}`)
                    .then(res => res.json())
                    .then(data => {
                        if (data.bodyFat === null) {
                            theBodyFat.innerHTML = "Please fill out all fields.";
                        } else {
                            theBodyFat.innerHTML = `Your calculated body fat percentage is ${data.bodyFat}%.`;
                        }
                    })     
                }
            }            

            // functions to retrieve ideal weight from local host
            function getIdealWeight() {
                const theHeight = document.querySelector("#height3").value;
                const theGender = document.querySelector("#gender2").value;

                fetch(`http://localhost:3000/idealweight?height=${theHeight}&gender=${theGender}`)
                .then(res => res.json())
                .then(data => {
                    if (data.idealWeight === null) {
                        theIdealWeight.innerHTML = "Please fill out all fields.";
                    } else {
                        theIdealWeight.innerHTML = `Your calculated ideal weight is ${data.idealWeight} kilograms.`;
                    }
                })
            }

            // function to retrieve calories to be burned from local host
            function getCalories() {
                const theWeight = document.querySelector("#weight3").value;
                const theHeight = document.querySelector("#height4").value;
                const theBMI = userBMIInput2.value;
                const theGender = document.querySelector("#gender3").value;
                const theAge = document.querySelector("#age2").value;
                const theGoal = document.querySelector("#goal").value;
                const theActivityLevel = document.querySelector("#activityLevel").value;

                // Check if any required field is missing or empty
                if (!theWeight || !theHeight || !theAge || !theGender || !theGoal || !theActivityLevel) {
                    theCalories.innerHTML = "Please fill out all fields.";
                    return;
                }

                // Make a GET request to the server's /caloriesburned endpoint
                const url = `http://localhost:3000/caloriesburned?bmi=${theBMI}&goal=${theGoal}&weight=${theWeight}&height=${theHeight}&age=${theAge}&gender=${theGender}&activityLevel=${theActivityLevel}`;
                fetch(url)
                    .then(res => res.json())
                    .then(data => {
                        if (data.recommendedCalories === null) {
                            theCalories.innerHTML = "Please fill out all fields.";
                        } else {
                            theCalories.innerHTML = `To achieve your goal, you must consume ${data.recommendedCalories} daily.`;
                        }
                    })
                    .catch(error => {
                        console.error('Error fetching data:', error.message);
                        theCalories.innerHTML = "An error occurred while fetching data. Please try again later.";
                    });
            }
        </script>
    </body>
</html>